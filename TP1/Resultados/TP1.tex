\documentclass[]{article}

\usepackage[utf8]{inputenc}
\usepackage{float}
\usepackage{listings}
\usepackage{pdflscape}
\usepackage{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage[usenames]{color}

\hypersetup{
	colorlinks=true,
	linkcolor=cyan,
	urlcolor=cyan,
}	

%opening
\title{Trabajo Práctico 1}
\author{Nicolás Muschitiello \\
	Roberto Vélez\\
	Jairo Jiménez
}

\begin{document}
	
	\maketitle
	
	\section{Introducción}
	
	En el presente informe, se presenta el resultado de trabajar con el algoritmo apriori \cite{Agrawal:1994:FAM:645920.672836} para generar reglas de asociación interesantes sobre una base de datos de ventas de una empresa.
	
	Se estructura en tres secciones: en la primera, se representan los resultados técnicos, que incluyen el detalle del preprocesamiento de los datos, software y algoritmo utilizado, justificación de la elección de los parámetros del mismo y explicación del criterio utilizado para la selección de los resultados no técnicos. En la segunda, aparecen los resultados no técnicos, que consisten en la selección de reglas interesantes, siguiendo distintos enfoques. Por último, se esboza una breve conclusión del trabajo realizado.
	
	
	\section{Resultados técnicos}
	\subsection{Preprocesamiento}
	En este apartado, describimos cómo preprocesamos las tablas previo a introducirlas en el algoritmo de generación de reglas de asociación:
	\begin{itemize}
		\item Comenzamos aplanando la base usando MS Access, con lo que se obtuvieron las variables presentadas en la tabla \ref{TablaVariables}.
		
		\begin{table}[]
			\centering
			\caption{Tabla de variables obtenidas}
			\label{TablaVariables}
			\begin{tabular}{lll}
				\multicolumn{1}{c}{{\bf Denominación}} & \multicolumn{1}{c}{{\bf Descripción}}                           & \multicolumn{1}{c}{{\bf Tabla de Origen}} \\
				\hline
				Cat\_Desc                              & Descrición de la Categoría a la que pertenece el Producto.      & TP\_Categoría                             \\
				cli\_CodPos                            & Código postal del Cliente.                                      & TP\_Clientes                              \\
				cli\_Loc                               & Localidad del Cliente.                                          & TP\_Clientes                              \\
				CLI\_NOM                               & Denominación del Cliente.                                       & TP\_Clientes                              \\
				CLI\_Prv                               & Provincia del Cliente.                                          & TP\_Clientes                              \\
				Precio                                 & Precio sugerido del Producto.                                   & TP\_Precio\_Sugerido                      \\
				CantEnvase                             & Medida de Cantidad.                                             & TP\_Productos                             \\
				Cat\_ID                                & ID de la Caegoría a la que pertenece el Producto.               & TP\_Productos                             \\
				DescAdic                               & Descripción Adicional del Producto.                             & TP\_Productos                             \\
				DescGen                                & Descripción Genérica del Producto.                              & TP\_Productos                             \\
				Marca                                  & Marca del Producto.                                             & TP\_Productos                             \\
				Prod\_ID                               & ID del Producto.                                                & TP\_Productos                             \\
				Proveedor                              & Proveedor.                                                      & TP\_Productos                             \\
				SubCat\_ID                             & ID de la Sub Categoría a la que pertenece el Producto.          & TP\_Productos                             \\
				SubCat\_Desc                           & Descripción de la Sub Categoría a la que pertenece el Producto. & TP\_Sub\_Categoría                        \\
				CLI\_ID                                & ID del Ciente.                                                  & TP\_Ventas                                \\
				SIT\_IVA\_ID                           & Situación ante el IVA del Cliente.                              & TP\_Ventas                                \\
				Venta\_Fecha                           & Fecha de la Venta.                                              & TP\_Ventas                                \\
				Cantidad\_UM1                          & Medida de Cantidad.                                             & TP\_Ventas\_Prod                          \\
				Cantidad\_UM2                          & Medida de Cantidad.                                             & TP\_Ventas\_Prod                          \\
				Fecha                                  & Fecha de la Venta.                                              & TP\_Ventas\_Prod                          \\
				Renglon                                & Número del renglón de la Venta.                                 & TP\_Ventas\_Prod                          \\
				Venta\_ID                              & ID de la Venta.                                                 & TP\_Ventas\_Prod                         
			\end{tabular}
		\end{table}
		
		\item Removimos de la base aplanada todos aquellos renglones que no tenían transacciones asociadas (entre ellos, 1 Categoría y 16 SubCategorías)
		\item Eliminamos 363 transacciones con cantidades negativas, ya que representan devoluciones.
		\item Detectamos la existencia productos con precio 0. Se decidió no hacer nada al respecto, aunque distorsionan las mediciones del gasto de los clientes y la ponderación de reglas por su impacto en las ventas
		\item Separamos el campo DescAdic, utilizando el siguiente procedimiento:
		\begin{enumerate}
			\item Realización de un query para sacar la categoría y subcategoría por producto con las descripciones generales y adicionales.  Estas últimas son las que vamos a separar en una tabla nueva que contendrá un registro por cada atributo con su valor asociado con la subcategoría. Ver Anexo 1 \ref{subsec:Anexo1}
			
			\item Realización de un script para separar la columna DescAdic, este script contiene la separación de la subcategoría primeramente para después poder separar los atributos que están identificados con la notación:
			\begin{center}
				\textit{Nombre del Atributo: Valor del Atributo}		
			\end{center}
			
			\item Realización de un script (ver Anexo) para generar un .csv con los nuevos registros para la tabla TP\_MarcaAtributos en R.
			
			\item Creación de la tabla en Access con las siguientes columnas:
			\begin{itemize}
				\item marca\_ID
				\item marca\_Nombre
				\item marca\_AtributoNombre
				\item marca\_AtributoValor
				\item SubCat\_ID	
			\end{itemize}	
			
		\end{enumerate}
		
		
	\end{itemize}
	
	
	
	Determinamos que casi toda la información contenida en este campo se encuentra codificada dentro de Prod\_ID, por lo que decidimos no trabajar a la hora de generar reglas con DescAdic.\\
	
	\begin{itemize}
		\item Como medida de volumen, decidimos trabajar con el campo Cantidad UM1
		\item Clasificamos los clientes siguiendo tres ejes: la cantidad de compras realizadas, el gasto incurrido en las mismas, y la categoría de los productos que compran. Para las dos primeras clasificaciones, utilizamos tres categorías para cada una, a saber:
		
		\begin{itemize}
			\item Cantidad de transacciones. Muy Frecuente: $\geq$ 14 transacciones (una compra por mes en promedio o más); Frecuente entre 7 y 13 (una compra cada dos meses o más); Poco Frecuente $<$ 7 (menos de una compra cada dos meses)
			\item Gasto. Gasto Alto $\geq$ \$ 500.000. Gasto Medio entre \$ 100.000 y \$ 499.999. Gasto Bajo $<$ \$ 100.000.
			\item Adicionalmente, determinamos su rubro (o rubros), a partir de los productos que compran, agrupados por categoría de acuerdo al siguiente esquema:
			\begin{itemize}
				\item Los clientes que compraron un 50\% o más de productos (COUNT DISTINCT Prod\_ID \& Venta\_ID) de una misma categoría, se clasifican con esa categoría
				
				\item A los clientes que no entran en la clasificación anterior, si entre las dos categorías mayoritarias suman más del 80\%, se utilizan ambas para su clasificación. Si no, se los clasifica como POLIRUBRO
			\end{itemize}
		\end{itemize}
		
	\end{itemize}
	
	
	
	\subsection{Software utilizado}
	En la elaboración del presente trabajo, se usaron gran variedad de herramientas de análisis de datos. El preprocesamiento de los datos se hizo conjuntamente con las herramientas Microsoft Excel, Microsoft Access y QlikView.\\
	
	Para la generación y evaluación de las reglas presentadas se exploraron las herramientas \textit{Weka} \cite{Weka1} y \textit{R} \cite{RCran}. Dada la flexibilidad de programación del software estadístico \textit{R}, se optó por este último.\\
	
	En dicho software, se implementaron los códigos necesarios para la generación de los conjuntos de datos en el formato requerido por el algoritmo, el cálculo de las medidas de interés adicionales y la poda de las reglas.
	
	\subsection{Justificación de la elección de los parámetros del algoritmo}
	La determinación del minsup se realizó a partir del análisis exploratorio de los datos. La confianza, a partir de iteraciones sucesivas del algoritmo y observar cuántas reglas interesantes generaba. Trabajamos con valores de 0.005 para el min support, y 0.6 para la confianza.% para la confianza.\\
	
	Adicionalmente, al no contar con conocimiento experto sobre la base de datos, se tomo la decisión de emplear otras medidas, las cuales se presentan en el apartado \ref{Medidas} 
	
	\subsection{Criterio para la selección de los resultados no técnicos}
	
	Para el análisis de las reglas interesantes, se decidió utilizar medidas adicionales a las medidas clásicas encontradas en el libro de \cite{Tan:2005:IDM:1095618}.
	
	\subsubsection{Medidas adicionales} \label{Medidas}
	Las medidas que fueron elegidas tienen la propiedad de ser \textit{null-invariantes}, es decir, no se ven afectadas por el efecto de la falta de la categoría en el conjunto de datos, adicionalmente, son más robustas que otras medidas con la misma propiedad como por ejemplo la confianza máxima o la confianza total. Las medidas utilizadas principalmente son la medida coseno y la medida de Kulczynsky, las cuales miden la correlación entre el antecedente y el consecuente de la regla, siendo 0 correlación negativa y 1 correlación positiva. Cuando el desbalanceo es muy alto entre los datos, la medida de Kulczynsky tiene valores cercanos a 0.5, mientras que la medida de coseno pierde robustez, en cuyo caso, se usa como soporte la medida de Razón de desbalanceo, la cual permite identificar las reglas interesantes como aquellas que tienen este índice cercano a 1 \cite{Hall:2009:WDM:1656274.1656278}. Estas medidas se presentan a continuación\\
	
	Medida coseno:
	
	\begin{center}
		$cosine(A,B) = \sqrt{P(A|B) \times P(B|A})$
	\end{center}
	
	Medida de Kulczynsky:
	
	\begin{center}
		$Kulc(A,B)= \frac{1}{2}\left(P(A|B) + P(B|A)\right)$	
	\end{center}
	
	Razón de desbalanceo:
	
	\begin{center}
		$IR = \frac{|sup(A)- sup(B)|}{sup(A)+ sup(B)-sup(A \cup B)}$	
	\end{center}
	
	\section{Resultados no técnicos esperados}
	
	Para la selección de las reglas en el presente capítulo, se tuvieron en cuenta las medidas descritas en la sección \ref*{Medidas}. Se tomaron las reglas que se consideraron interesantes con respecto a dichas medidas.
	
	
	\subsection{Características más habituales de las ventas de la empresa}
	
	La mayoría de las reglas interesantes que se presentan en este apartado son de nivel Categoría o Subcategoría, porque entendemos que resumen mejor la actividad de la empresa.\\
	
	En este sentido observamos que, consistentemente con lo detectado en el análisis exploratorio de los datos, todas las reglas involucran artículos de camping o pesca (al hablar de pesca nos referimos tanto a PESCA, como a PESCA REELS y PESCA CAÑAS), que son los dos rubros más representativos a nivel ventas, tanto si se lo mide a partir de la cantidad de transacciones como del monto.\\ 
	
	Como diferencia metodológica con respecto al resto de los puntos de este apartado, se decidió, para algunos casos, prescindir de la medida de kulczinsky, de manera tal que sobrevivan al filtrado algunas reglas que consideramos aportan información relevante. Estas reglas se presentan en la tabla \ref{Tab_Reg_Habituales}.
	
	\subsection{Reglas generadas a partir de las variables demográficas}
	En general las relaciones existentes entre las variables demográficas y los productos, descripción general de los productos, subcategorías y categorías es muy poca. A nivel de producto, las reglas encontradas suelen no ser muy interesantes pues éstas solamente relacionan botellas con botellas o termos con termos, sin embargo, éstas tienen dos particularidades: todas tienen una correlación positiva entre el antecedente y el consecuente y todas están relacionadas con la localidad y la provincia de Buenos Aires.\\
	
	En cuanto a los demás grupos (descripción general, subcategoría y categoría), las correlaciones encontradas son negativas mostrando una "repelencia" entre los ítems y las ciudades en las cuales se encuentran. Las reglas nombradas, son presentadas en la tabla  \ref{Tab_Reg_Demog}.
	
	\subsection{Reglas a nivel de monto y cantidad de ventas de la empresa}
	
	En este apartado, se buscó seleccionar reglas interesantes desde un punto de vista económico, ponderando las mismas por la cantidad de ventas que involucran y su monto.\\
	
	El primer factor se encuentra resumido en el soporte, mientras que para el segundo se calculó, para cada regla, el ingreso que le reportó al negocio en el período analizado la venta de los ítems que la componen.\\
	
	En cuanto a la selección de las reglas, se le dio prioridad, más allá del criterio explicitado en el párrafo anterior, a aquellas generadas a nivel producto, entendiendo que, sin conocimiento de la empresa, son las que pueden resultar menos obvias o triviales.\\
	
	Por el mismo motivo (desconocimiento del negocio) presentamos un par de reglas que pueden parecer redundantes, por ejemplo: BASTÓN TREKKING y PEDERNAL PARA ENCENDER EL FUEGO a nivel producto ({ERNE} =\textgreater {FSTONE01}) y luego una regla que involucra estos productos a nivel de Descripción General. Las reglas son presentadas en la tabla \ref{Tab_Reg_Monto}.
	
	\subsection{Reglas generadas de un año a otro}
	Las reglas presentadas a continuación fueron tomadas con las siguientes condiciones:
	\begin{itemize}
		\item El periodo de comparación fue del 2014 con respecto a los meses de enero a mayo del 2015
		\item Las reglas generadas e identificadas como interesantes reflejan un periodo de comparación bastante diferente entre un año y otro por lo que muchas encontradas en el año 2015 no se cumplían en 2014 y viceversa.
	\end{itemize}
	
	Como se mencionó en los apartados anteriores para la selección de las reglas se uso la medida Kulczynsky, la cual en ambas tablas tiene valores altos y en el caso de algunas reglas con valor de 0.50 se usó la razón de desbalanceo (IR) para ayudar en la decisión.\\
	
	En el resultado encontrado de las reglas generadas en ambos años, por ID de producto las lupas con diferentes aumentos comprados por casas de óptica es una característica que sobresale en ambos años. Por otro lado la compra de botellas de color rojo y azul de 500cc y 750cc con botellas color plateado de 500cc, también se reflejan como transacciones muy frecuentes. Finalmente, otra regla bastante interesante es la compra de termos de tipo rojo y azul en medidas de 400cc por las casas de pesca.\\
	
	Con respecto a la descripción del producto, se puede apreciar que las reglas interesantes comprenden compra de binoculares del tipo travel II, lupas de mano y lupas profesionales por casas de óptica; de la misma manera, sombreros y capas por las casas de pesca. Una regla bastante interesante es la de la compra de bolsas para dormir tipo Gravity, por casas con un gasto medio, de camping y con un patrón de compra frecuente en ambos años.\\
	
	Por el lado de las subcategorias se destacan un par de reglas interesantes referentes a las cañas de tipo fly y sus correspondientes accesorios del mismo tipo (líneas y reels) comprados por casas de pesca, mientras que las bolsas de dormir rectangulares se asocian a casas con un gasto alto y compras muy frecuentes. Similarmente la regla de compra de binoculares, linternas por casas de opticas indica la compra de lupas en general.\\
	
	En las reglas obtenidas por categoria, vemos que destacan las casas que compran muy frecuente, con las casas de pesca y con gastos altos para ambos años. De la misma manera artículos de camping, pesca, cañas de pescar compradas por las casas de pesca implican compra de reels, así como también artículos de camping, indumentaria, cañas de pescar y pesca ocurren frecuentemente para casas de pesca.\\
	
	La tabla \ref{Tab_Reg_Anio2014} presenta las reglas interesantes encontradas para el 2014, mientras que la tabla \ref{Tab_Reg_Anio2015} contiene el cálculo de las medidas a mano del 2015 para las mismas reglas que resultaron interesantes en el 2014, ambas tablas ordenadas por la medida Kulczynsky.
	
	\newgeometry{left=3cm,bottom=0.1cm}
	\begin{landscape}
		\begin{table}[htbp]
			\centering
			\caption{Reglas más habituales}
			\renewcommand{\arraystretch}{1.2}
			\addtolength{\tabcolsep}{-1.5pt}
			\begin{tabular}{llllllll}
				\textbf{Regla} & \textbf{Soporte} & \textbf{Confianza} & \textbf{Lift} & \textbf{Coseno} & \textbf{Kulczinsky} & \textbf{IR} & \textbf{Grupo} \\
				\hline 		
				{CAMPING,INDUMENTARIA,PESCA,PESCA CAÑAS} =\textgreater {PESCA REELS} & 0.016 & 0.831 & 3.768 & 0.248 & 0.452 & 0.897 & Categoría \\
				{CAMPING,INDUMENTARIA,PESCA REELS,TIRO Y DEFENSA} =\textgreater {PESCA} & 0.006 & 0.946 & 2.862 & 0.126 & 0.481 & 0.981 & Categoría \\
				{CAMPING,PESCA CAÑAS} =\textgreater {PESCA} & 0.072 & 0.722 & 2.185 & 0.396 & 0.470 & 0.645 & Categoría \\
				{CAMPING,INDUMENTARIA,PESCA REELS,TIRO Y DEFENSA} =\textgreater {PESCA CAÑAS} & 0.005 & 0.919 & 3.996 & 0.147 & 0.471 & 0.972 & Categoría \\
				{CAMPING,PESCA CAnAS} =\textgreater {PESCA REELS} & 0.077 & 0.773 & 3.508 & 0.519 & 0.561 & 0.498 & Categoría \\
				{INDUMENTARIA,INDUMENTARIA PESCA,PESCA,PESCA REELS} =\textgreater {PESCA CAÑAS} & 0.008 & 0.909 & 3.953 & 0.177 & 0.472 & 0.959 & Categoría \\
				{PESCA,PESCA CAÑAS} =\textgreater {PESCA REELS} & 0.103 & 0.778 & 3.532 & 0.604 & 0.623 & 0.352 & Categoría \\
				{INDUMENTARIA PESCA,PESCA REELS,TIRO Y DEFENSA} =\textgreater {PESCA} & 0.007 & 0.933 & 2.824 & 0.137 & 0.477 & 0.977 & Categoría \\
				{INDUMENTARIA PESCA,PESCA REELS} =\textgreater {PESCA CAÑAS} & 0.030 & 0.802 & 3.487 & 0.321 & 0.465 & 0.814 & Categoría \\
				{PESCA REELS} =\textgreater {PESCA} & 0.135 & 0.613 & 1.855 & 0.501 & 0.511 & 0.265 & Categoría \\
				{PESCA REELS} =\textgreater {PESCA CAÑAS} & 0.168 & 0.764 & 3.321 & 0.748 & 0.748 & 0.034 & Categoría \\
				{CAÑAS VARIADA,CARPAS} =\textgreater {REELS VARIADA} & 0.007 & 0.738 & 5.214 & 0.193 & 0.394 & 0.915 & SubCategoría \\
				{CAÑAS VARIADA,REELS PEJERREY} =\textgreater {REELS VARIADA} & 0.045 & 0.764 & 5.397 & 0.491 & 0.539 & 0.535 & SubCategoría \\
				{COCINA OUTDOOR} =\textgreater {JARROS, BOTELLAS Y TERMOS} & 0.014 & 0.634 & 3.913 & 0.236 & 0.361 & 0.819 & SubCategoría \\
				{ACCESORIOS PESCA,CAnAS PEJERREY,REELS VARIADA} =\textgreater {CAÑAS VARIADA} & 0.005 & 0.914 & 7.400 & 0.194 & 0.478 & 0.951 & SubCategoría \\
				{CAÑAS VARIADA} =\textgreater {REELS VARIADA} & 0.077 & 0.625 & 4.415 & 0.584 & 0.585 & 0.096 & SubCategoría \\
				{REELS PEJERREY} =\textgreater {REELS VARIADA} & 0.077 & 0.601 & 4.246 & 0.571 & 0.571 & 0.072 & SubCategoría \\
				{LiNEA MONOFILAMENTO,SOMBRERO DE ALA} =\textgreater {CAP CON VISERA} & 0.006 & 0.851 & 14.804 & 0.307 & 0.481 & 0.854 & Desc. General \\
				{ACCESORIOS FLY,CAnAS FLY,LINEAS FLY} =\textgreater {REELS FLY} & 0.005 & 0.917 & 30.221 & 0.398 & 0.545 & 0.799 & SubCategoría \\
				{CAÑAS FLY,LINEAS FLY} =\textgreater {REELS FLY} & 0.009 & 0.763 & 25.160 & 0.481 & 0.533 & 0.550 & SubCategoría \\
				{REELS FLY} =\textgreater {CAÑAS FLY} & 0.019 & 0.634 & 18.051 & 0.589 & 0.591 & 0.103 & SubCategoría \\
				{PASAHILOS} =\textgreater {PUNTERA} & 0.015 & 0.612 & 18.886 & 0.528 & 0.534 & 0.198 & Desc. General \\		 			
			\end{tabular}%
			\label{Tab_Reg_Habituales}%
		\end{table}%
		
	\end{landscape}
	\restoregeometry
		
	\newgeometry{left=3cm,bottom=0.1cm}
	\begin{landscape}
		
		\begin{table}[]
			\centering
			\caption{Reglas con información demográfica}
			\label{Tab_Reg_Demog}
			\begin{tabular}{llllllll}
				{\bf Reglas}                                                                         & {\bf Soporte} & {\bf Confianza} & {\bf Lift} & {\bf Coseno} & {\bf Kulczinsky} & {\bf IR} & {\bf Grupo}  \\
				\hline
				BTP4S79-5RC,BTP4S79-75RC,BTP4S79-75SC,Capital Federal-Prov =\textgreater BTP4S79-5SC & 0,006         & 1,000           & 49,024     & 0,525        & 0,638            & 0,724    & Producto     \\
				LCM1406NB,Buenos Aires-Prov =\textgreater LCM1406NR                                  & 0,005         & 0,944           & 49,001     & 0,517        & 0,614            & 0,689    & Producto     \\
				BTP4S79-75BLC,Capital Federal-Prov =\textgreater BTP4S79-75RC                        & 0,010         & 0,878           & 29,089     & 0,551        & 0,612            & 0,579    & Producto     \\
				LINEAS FLY,Capital Federal-Prov =\textgreater CAnAS FLY                              & 0,006         & 0,609           & 17,324     & 0,329        & 0,394            & 0,635    & Subcategoría \\
				GENERAL ROCA-Loc =\textgreater PESCA                                                 & 0,008         & 0,627           & 1,892      & 0,126        & 0,326            & 0,946    & Categoría    \\
				Tucuman-Prov =\textgreater PESCA                                                     & 0,009         & 0,621           & 1,875      & 0,133        & 0,325            & 0,938    & Categoría    \\
				RESISTENCIA-Loc =\textgreater CAMPING                                                & 0,005         & 0,630           & 1,135      & 0,079        & 0,320            & 0,979    & Categoría    \\
				EL PALOMAR-Loc =\textgreater PESCA                                                   & 0,008         & 0,613           & 1,849      & 0,121        & 0,318            & 0,947    & Categoría    \\
				TORTUGUITAS-Loc =\textgreater CAMPING                                                & 0,005         & 0,618           & 1,114      & 0,078        & 0,314            & 0,978    & Categoría    \\
				MONTE GRANDE-Loc =\textgreater CAMPING                                               & 0,005         & 0,607           & 1,094      & 0,077        & 0,308            & 0,978    & Categoría   
			\end{tabular}
		\end{table}
		

	\end{landscape}
	\restoregeometry
	
	
	\newgeometry{left=3cm,bottom=0.1cm}
	\begin{landscape}
		\begin{table}[htbp]
			\centering
			\caption{Reglas a nivel monto}
			\addtolength{\tabcolsep}{-3.5pt}
			\renewcommand{\arraystretch}{1.2} 
			\begin{tabular}{llllllllll}
				\textbf{Regla} & \textbf{Soporte} & \textbf{Conf.} & \textbf{lift} & \textbf{Coseno} & \textbf{Kulcz.} & \textbf{IR} & \textbf{Monto} & \textbf{Grupo} \\	
				\hline					
				{CAÑAS VARIADA,NYLON} =\textgreater {REELS VARIADA} & 0.028 & 0.726 & 5.132 & 0.378 & 0.461 & 0.679 &  \$ 19,485,499  & SubCategoría \\
				{MOCHILAS DSICOVERY,MOCHILAS URBANAS} =\textgreater {MOCHILAS SUPER MOUNTAIN} & 0.005 & 0.842 & 17.915 & 0.302 & 0.475 & 0.854 &  \$    6,453,944  & Desc. General \\
				{BINOCULAR ORBITAL,LUPA PROFESIONALES} =\textgreater {LUPA DE MANO} & 0.007 & 0.854 & 23.591 & 0.392 & 0.517 & 0.766 &  \$    2,693,876  & Desc. General \\
				{LCM1406NR,TA1001A} =\textgreater {LCM1406NB} & 0.005 & 0.943 & 47.497 & 0.499 & 0.603 & 0.709 &  \$    1,987,561  & Producto \\
				{SOMBRERO DE ALA} =\textgreater {CAP CON VISERA} & 0.026 & 0.763 & 13.273 & 0.583 & 0.604 & 0.367 &  \$    1,895,555  & Desc. General \\
				{BINOCULAR TRAVEL II,LUPA DE MANO} =\textgreater {LUPA PROFESIONALES} & 0.007 & 0.788 & 20.601 & 0.366 & 0.479 & 0.750 &  \$    1,210,547  & Desc. General \\
				{LiNEA FLY SINKING BLACK} =\textgreater {LiNEA FLY FLOATING ORANGE} & 0.010 & 0.753 & 36.200 & 0.592 & 0.609 & 0.331 &  \$       961,779  & Desc. General \\
				{BASToN TREKKING,PEDERNAL PARA ENCENDER FUEGO} =\textgreater {MANTA DE EMERGENCIA} & 0.006 & 0.809 & 66.989 & 0.636 & 0.654 & 0.341 &  \$       852,082  & Desc. General \\
				{BALLESTA} =\textgreater {ARCO} & 0.006 & 0.673 & 44.127 & 0.509 & 0.529 & 0.360 &  \$       788,392  & Desc. General \\
				{LUPA PROFESIONALES,TERMoMETRO} =\textgreater {LUPA DE MANO} & 0.006 & 0.830 & 22.917 & 0.377 & 0.500 & 0.767 &  \$       596,152  & Desc. General \\
				{LUPA DE CAMPO,LUPA PROFESIONALES} =\textgreater {LUPA DE MANO} & 0.007 & 0.837 & 23.109 & 0.388 & 0.508 & 0.758 &  \$       482,369  & Desc. General \\
				{JACO10} =\textgreater {NOMA10} & 0.006 & 0.632 & 59.359 & 0.583 & 0.584 & 0.114 &  \$       307,650  & Producto \\
				{ERNE} =\textgreater {FSTONE01} & 0.006 & 0.648 & 48.016 & 0.517 & 0.530 & 0.298 &  \$       285,939  & Producto \\
				{WASABI10} =\textgreater {MIRAZUR} & 0.007 & 0.776 & 81.427 & 0.763 & 0.763 & 0.027 &  \$       278,881  & Producto \\
				{MIRAZUR} =\textgreater {NOMA10} & 0.006 & 0.633 & 59.524 & 0.599 & 0.600 & 0.079 &  \$       268,426  & Producto \\
				{MG1968,TN4X30-1} =\textgreater {TN4X30-3} & 0.007 & 0.811 & 33.391 & 0.478 & 0.546 & 0.613 &  \$       261,638  & Producto \\
			\end{tabular}%
			\label{Tab_Reg_Monto}%
		\end{table}%	
	\end{landscape}
	\restoregeometry
	
	\newgeometry{left=3cm,bottom=0.1cm}
		\begin{landscape}
			% Table generated by Excel2LaTeX from sheet 'ReglasFinales2014v2'
			\begin{table}[htbp]
				\centering
				\caption{Reglas Interesantes del 2014}
				\renewcommand{\arraystretch}{1.2}
				\addtolength{\tabcolsep}{-1.5pt}
				\begin{tabular}{llllllll}
					\textbf Reglas & \textbf Soporte & \textbf Confianza & \textbf Lift & \textbf Coseno & \textbf Kulczinsky & \textbf IR & \textbf Grupo \\
					\hline
					\renewcommand{\arraystretch}{1.2}
					{BTP4S79-5RC,BTP4S79-75RC,BTP4S79-75SC,Muy Frecuente} =\textgreater {BTP4S79-5SC} & 0.007 & 0.971 & 58.350 & 0.659 & 0.709 & 0.532 & Producto \\
					{MG1970,CASA DE OPTICA} =\textgreater {MG1968} & 0.012 & 0.844 & 38.136 & 0.672 & 0.689 & 0.333 & Producto \\
					{LCM1406NR,CASA DE PESCA} =\textgreater {LCM1406NB} & 0.008 & 0.923 & 46.306 & 0.604 & 0.659 & 0.553 & Producto \\
					{BTP4S79-5RC,BTP4S79-75RC,CASA DE CAMPING} =\textgreater {BTP4S79-5BLC} & 0.005 & 1.000 & 55.000 & 0.549 & 0.651 & 0.699 & Producto \\
					{HPR50600,Gasto Bajo,CASA DE OPTICA} =\textgreater {HPR50360} & 0.007 & 0.625 & 25.938 & 0.413 & 0.449 & 0.484 & Producto \\
					{SOMBRERO DE ALA,CASA DE PESCA} =\textgreater {CAP CON VISERA} & 0.014 & 0.816 & 16.406 & 0.472 & 0.544 & 0.627 & Desc. General \\
					{PASAHILOS,CASA DE PESCA} =\textgreater {PUNTERA} & 0.013 & 0.641 & 22.178 & 0.535 & 0.544 & 0.242 & Desc. General \\
					{CAJA DE POLIPROPILENO,CAJA TRANSPARENTE} =\textgreater {CASA DE PESCA} & 0.006 & 1.000 & 2.010 & 0.111 & 0.506 & 0.988 & Desc. General \\
					{BINOCULAR TRAVEL II,LUPA DE MANO,CASA DE OPTICA} =\textgreater {LUPA PROFESIONALES} & 0.005 & 0.852 & 21.847 & 0.332 & 0.491 & 0.830 & Desc. General \\
					{BOLSA DE DORMIR GRAVITY - 230 x 80 x 55,Gasto Medio} =\textgreater {CASA DE CAMPING} & 0.009 & 0.619 & 3.290 & 0.168 & 0.332 & 0.901 & Desc. General \\
					{BOLSAS DORMIR RECTANGULAR,Gasto Alto} =\textgreater {Muy Frecuente} & 0.038 & 1.000 & 1.559 & 0.243 & 0.530 & 0.941 & Subcategoria \\
					{Gasto Bajo,CASA DE PESCA} =\textgreater {Poco Frecuente} & 0.061 & 0.700 & 3.902 & 0.489 & 0.521 & 0.446 & Subcategoria \\
					{CAÑAS VARIADA,REELS PEJERREY,Gasto Medio} =\textgreater {CASA DE PESCA} & 0.013 & 0.923 & 1.856 & 0.156 & 0.475 & 0.969 & Subcategoria \\
					{CAÑAS FLY,LINEAS FLY,CASA DE PESCA} =\textgreater {REELS FLY} & 0.005 & 0.719 & 28.285 & 0.378 & 0.459 & 0.672 & Subcategoria \\
					{TELESCOPIOS REFRACTORES,Gasto Bajo} =\textgreater {CASA DE OPTICA} & 0.019 & 0.763 & 5.556 & 0.325 & 0.451 & 0.784 & Subcategoria \\
					{BINOCULARES CLASICOS,LINTERNAS,CASA DE OPTICA} =\textgreater {LUPAS} & 0.006 & 0.763 & 11.422 & 0.269 & 0.429 & 0.850 & Subcategoria \\
					{Muy Frecuente,CASA DE PESCA} =\textgreater {Gasto Alto} & 0.272 & 0.803 & 1.837 & 0.707 & 0.712 & 0.195 & Categoria \\
					{PESCA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA REELS} & 0.072 & 0.764 & 4.137 & 0.544 & 0.576 & 0.440 & Categoria \\
					{OPTICA,Gasto Alto,CASA POLIRUBRO} =\textgreater {Muy Frecuente} & 0.007 & 1.000 & 1.559 & 0.103 & 0.505 & 0.989 & Categoria \\
					{CAMPING,PESCA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA REELS} & 0.034 & 0.766 & 4.147 & 0.378 & 0.476 & 0.716 & Categoria \\
					{CAMPING,INDUMENTARIA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA} & 0.011 & 0.754 & 2.526 & 0.170 & 0.396 & 0.938 & Categoria \\
				\end{tabular}%
				\label{Tab_Reg_Anio2014}%
			\end{table}%		
		\end{landscape}
	\restoregeometry
	\newgeometry{left=3cm,bottom=0.1cm}
	\begin{landscape}
		
		% Table generated by Excel2LaTeX from sheet 'ReglasFinales'
		\begin{table}[htbp]
			\centering
			\caption{Reglas del 2015 con valores calculados a mano en base a las Interesantes del 2014}
			\renewcommand{\arraystretch}{1.2}
			\addtolength{\tabcolsep}{-1.5pt}
			\begin{tabular}{llllllll}
				\textbf Reglas & \textbf Soporte & \textbf Confianza & \textbf Lift & \textbf Coseno & \textbf Kulczinsky & \textbf IR & \textbf Grupo \\
				\hline
				\renewcommand{\arraystretch}{1.2}
				{MG1970,CASA DE OPTICA} =\textgreater {MG1968} & 0.008 & 1     & 52.485 & 0.651 & 0.712 & 0.576 & Producto \\
				{BTP4S79-5RC,BTP4S79-75RC,BTP4S79-75SC,Muy Frecuente} =\textgreater {BTP4S79-5SC} & 0.011 & 0.950 & 30.470 & 0.578 & 0.651 & 0.618 & Producto \\
				{LCM1406NR,CASA DE PESCA} =\textgreater {LCM1406NB} & 0.007 & 0.923 & 47.023 & 0.571 & 0.638 & 0.600 & Producto \\
				{BTP4S79-5RC,BTP4S79-75RC,CASA DE CAMPING} =\textgreater {BTP4S79-5BLC} & 0.009 & 0.833 & 32.803 & 0.533 & 0.587 & 0.553 & Producto \\
				{HPR50600,Gasto Bajo,CASA DE OPTICA} =\textgreater {HPR50360} & 0.007 & 0.706 & 30.565 & 0.460 & 0.503 & 0.511 & Producto \\
				{BINOCULAR TRAVEL II,LUPA DE MANO,CASA DE OPTICA} =\textgreater {LUPA PROFESIONALES} & 0.008 & 1     & 27.492 & 0.454 & 0.603 & 0.794 & Desc. General \\
				{PASAHILOS,CASA DE PESCA} =\textgreater {PUNTERA} & 0.019 & 0.660 & 15.877 & 0.550 & 0.559 & 0.247 & Desc. General \\
				{CAJA DE POLIPROPILENO,CAJA TRANSPARENTE} =\textgreater {CASA DE PESCA} & 0.010 & 0.900 & 1.676 & 0.132 & 0.460 & 0.976 & Desc. General \\
				{SOMBRERO DE ALA,CASA DE PESCA} =\textgreater {CAP CON VISERA} & 0.013 & 0.733 & 9.408 & 0.346 & 0.448 & 0.734 & Desc. General \\
				{BOLSA DE DORMIR GRAVITY - 230 x 80 x 55,Gasto Medio} =\textgreater {CASA DE CAMPING} & 0.008 & 0.636 & 3.444 & 0.167 & 0.340 & 0.909 & Desc. General \\
				{CAÑAS FLY,LINEAS FLY,CASA DE PESCA} =\textgreater {REELS FLY} & 0.016 & 0.903 & 20.858 & 0.581 & 0.638 & 0.564 & Subcategoria \\
				{Gasto Bajo,CASA DE PESCA} =\textgreater {Poco Frecuente} & 0.074 & 0.705 & 3.666 & 0.523 & 0.546 & 0.388 & Subcategoria \\
				{TELESCOPIOS REFRACTORES,Gasto Bajo} =\textgreater {CASA DE OPTICA} & 0.022 & 0.884 & 9.165 & 0.448 & 0.556 & 0.721 & Subcategoria \\
				{BOLSAS DORMIR RECTANGULAR,Gasto Alto} =\textgreater {Muy Frecuente} & 0.028 & 1     & 1.605 & 0.213 & 0.523 & 0.955 & Subcategoria \\
				{BINOCULARES CLASICOS,LINTERNAS,CASA DE OPTICA} =\textgreater {LUPAS} & 0.008 & 0.929 & 13.865 & 0.323 & 0.520 & 0.872 & Subcategoria \\
				{CAÑAS VARIADA,REELS PEJERREY,Gasto Medio} =\textgreater {CASA DE PESCA} & 0.028 & 0.860 & 1.601 & 0.213 & 0.456 & 0.931 & Subcategoria \\
				{Muy Frecuente,CASA DE PESCA} =\textgreater {Gasto Alto} & 0.246 & 0.742 & 1.860 & 0.676 & 0.679 & 0.139 & Categoria \\
				{PESCA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA REELS} & 0.143 & 0.832 & 2.643 & 0.614 & 0.642 & 0.417 & Categoria \\
				{CAMPING,PESCA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA REELS} & 0.083 & 0.856 & 2.721 & 0.474 & 0.559 & 0.664 & Categoria \\
				{CAMPING,INDUMENTARIA,PESCA CAÑAS,CASA DE PESCA} =\textgreater {PESCA} & 0.027 & 0.979 & 2.359 & 0.253 & 0.522 & 0.932 & Categoria \\
				{OPTICA,Gasto Alto,CASA POLIRUBRO} =\textgreater {Muy Frecuente} & 0.009 & 1     & 1.605 & 0.122 & 0.507 & 0.985 & Categoria \\
			\end{tabular}%
			\label{Tab_Reg_Anio2015}%
		\end{table}%
		
		
	\end{landscape}
	\restoregeometry
	\section{Bonus}
	Basado en todas las reglas generadas entre la tabla 1, 2 y 4 pero de manera especial en las siguientes:\\
	\begin{itemize}
		\item PESCA REELS =\textgreater PESCA
		\item BTP4S79-5RC,BTP4S79-75RC,BTP4S79-75SC,Capital Federal-Prov =\textgreater BTP4S79-5SC
		\item BTP4S79-5RC,BTP4S79-75RC,BTP4S79-75SC,Muy Frecuente =\textgreater BTP4S79-5SC
		\item CA~NAS FLY,LINEAS FLY,CASA DE PESCA =\textgreater REELS FLY\\
	\end{itemize}
	 Proponemos una promoción que consista en que: 
	\begin{itemize}
		\item Las compras realizadas en artículos de pesca de preferencia cañas de pescar de diferente tipo se les ofrezca llevar gratis una botella de 500 o 750cc de color a elección (rojo, azul o plateado) para los clientes de Capital Federal.\\
	\end{itemize}

	\section{Conclusiones}
	\begin{itemize}
		\item En un primer análisis exploratorio de los datos encontramos cierto ruido (transacciones con cantidades negativos, productos con precio de referencia cero, etc.) que era necesario trabajarlo previo a poder aplicar un algoritmo para encontrar items frecuentes en las transacciones derivadas de las ventas, esto ratifica que es importante conocer los datos porque se corre el riesgo de encontrar reglas que no muestren la verdadera dinámica del negocio.\\
		\item A pesar de que no se conoce todo el negocio en su complejidad, creemos que una gran parte de las reglas encontradas son triviales, sin embargo cabe mencionar que las medidas que utilizamos nos permitieron discrimar de mejor manera entre este tipo de reglas.\\
		\item Consideramos que por todo el conocimiento generado entre el análisis exploratorio y las reglas obtenidas el perfil de la mayoria de los clientes apunta a distribuidores mayoristas, por lo que pensamos que esta sea la razon por la cual hallamos muchas reglas triviales.\\
	\end{itemize}
	
	\section{Anexos}
	
	El presente trabajo fue realizado utilizando una herramienta de desarrollo colaborativo basado en el control de versiones como lo es github.\\
	
	\noindent En el siguiente \href{https://github.com/jairoji/DM_TP1/tree/master/TP1}{enlace} pueden encontrarse los recursos utilizados para la elaboración del informe.\\
	 
	
	\noindent La estructura del repositorio está formada por cuatro carpetas:\\
	
	\textbf{Análisis}: Contiene notas hechas por el grupo para la elaboración del informe, primera version de la base de datos consolidada y una base con la separación de la descripción adicional del producto en una nueva tabla como parte del preprocesamiento.\\
	
	\textbf{Insumos}: Contiene todos los recursos necesarios (archivos de excel de las diferentes tablas) utilizados para formar los múltiples consolidados que se usaron para generar las reglas.\\
	
	\textbf{Resultados}: Aquí se puede encontrar la base final consolidada la cual se tomó como entrada el algoritmo que generó las reglas así como también todos los  archivos en formato de excel con las reglas para cada una de las secciones del informe.\\
	
	\textbf{Sintaxis}: Contiene los scripts en R utilizados para generar las reglas y para separar el campo descripción adicional, con la generación del .csv para importarse como nueva tabla al modelo original en Access.\\
	
	\bibliographystyle{apalike}
	\bibliography{Bibliografia}
	
	\section*{Anexos}
	\subsection*{Anexo 1}
	\label{subsec:Anexo1}
		\begin{lstlisting}[
		language=SQL,
		showspaces=false,
		basicstyle=\ttfamily,
		commentstyle=\color{gray},
		breaklines=true
		]
		SELECT TP_Categoria.Cat_ID, TP_Categoria.Cat_Desc, TP_Sub_Categoria.SubCat_ID, TP_Sub_Categoria.SubCat_Desc, TP_Productos.DescGen, TP_Productos.DescAdic
		FROM TP_Sub_Categoria INNER JOIN (TP_Categoria INNER JOIN TP_Productos ON TP_Categoria.Cat_ID = TP_Productos.Cat_ID) ON TP_Sub_Categoria.SubCat_ID = TP_Productos.SubCat_ID;
		
		\end{lstlisting}
	
	
\end{document}
